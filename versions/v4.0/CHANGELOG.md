# Changelog - SPIN Training Bot v4.0

Все значимые изменения в этой версии документируются в этом файле.

## [4.0.0] - 2025-01-16

### Добавлено
- Полная интеграция системы промокодов
- Система подписок и оплаты
- Проверка подписки на канал @TaktikaKutuzova через getChatMember
- Бесплатные тренировки за подписку на канал (2 тренировки)
- Админ-панель для управления промокодами
- Гибридная воронка продаж (SPIN + прямое предложение)
- Многоуровневая архитектура базы данных (PostgreSQL/SQLite)
- Health check server для мониторинга
- Полная документация всех сообщений бота
- Скрипты для управления пользователями и данными

### Изменено
- Рефакторинг архитектуры для поддержки multi-bot
- Улучшена обработка ошибок и логирование
- Оптимизирована работа с базой данных (async/await)
- Улучшена производительность polling (timeout, poll_interval)
- Обновлены тексты сообщений для лучшей конверсии

### Исправлено
- Проблемы с event loop (удален nest_asyncio из основного кода)
- Обработка ошибки "Message is not modified"
- Проверка статуса подписки на канал (creator status)
- ConversationHandler для промокодов
- Коммит транзакций перед проверкой доступа

### Документация
- DATABASE_ARCHITECTURE.md - полное описание архитектуры БД
- DIALOG_TREE.md - дерево диалогов бота
- PERFORMANCE.md - оптимизация производительности
- CHANNEL_SUBSCRIPTION_FLOW.md - функционал подписки на канал
- MESSAGES_DOCUMENTATION.md - все текстовые сообщения
- RAILWAY_DEPLOY_v4.md - инструкции по деплою

---

Полный список изменений доступен в файлах документации в папке `docs/`.

