# üöÇ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ v4.0 –Ω–∞ Railway (–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å)

## üéØ –¶–µ–ª—å
- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è v4.0, –Ω–µ —Ç—Ä–æ–≥–∞—è —Å—Ç–∞—Ä—ã–π
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å PostgreSQL –∫ –Ω–æ–≤–æ–º—É —Å–µ—Ä–≤–∏—Å—É
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –≤ Railway

1. **–í Railway Dashboard:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç "peaceful-dedication"
   - –ù–∞–∂–º–∏—Ç–µ **"+"** (–ø–ª—é—Å) –≤ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –∏–ª–∏ **"New"** ‚Üí **"Service"**
   - –í—ã–±–µ—Ä–∏—Ç–µ **"GitHub Repo"**
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π **"SPIN-Training-Bot"**

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞:**
   - **Branch:** –≤—ã–±–µ—Ä–∏—Ç–µ `v4.0` (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ, –µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–ø—É—à–µ–Ω–∞)
   - **Root Directory:** —É–∫–∞–∂–∏—Ç–µ `versions/v4.0`
   - –ù–∞–∂–º–∏—Ç–µ **"Deploy"**

3. **–ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞:**
   - Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "prolific-reflection-v4")
   - –ò–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –µ–≥–æ –≤ **Settings** ‚Üí **Name**: `spin-bot-v4` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∏–º—è)

### –®–∞–≥ 2: –ü–æ–¥–∫–ª—é—á–∏—Ç—å PostgreSQL –∫ –Ω–æ–≤–æ–º—É —Å–µ—Ä–≤–∏—Å—É

1. **–í Railway Dashboard:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
   - –ù–∞–π–¥–∏—Ç–µ —Å–µ—Ä–≤–∏—Å **"Postgres"** –≤ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏
   - –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ

2. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –Ω–æ–≤–æ–º—É —Å–µ—Ä–≤–∏—Å—É:**
   - –í –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ —Å–µ—Ä–≤–∏—Å–∞ Postgres –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"Connect"** –∏–ª–∏ **"Variables"**
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `DATABASE_URL` (–∏–ª–∏ `PGDATABASE`, `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`)

3. **–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å v4.0:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å v4.0
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"Variables"** (–≤–∫–ª–∞–¥–∫–∞ –≤ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏)
   - –ù–∞–∂–º–∏—Ç–µ **"New Variable"**
   - –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
     - **Name:** `DATABASE_URL`
     - **Value:** –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ Postgres —Å–µ—Ä–≤–∏—Å–∞
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **"Generate"** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

4. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ Network):**
   - –í Railway –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ **Network**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å v4.0 ‚Üí **Settings** ‚Üí **Networking**
   - –î–æ–±–∞–≤—å—Ç–µ Postgres –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (–µ—Å–ª–∏ —Ç–∞–∫–∞—è –æ–ø—Ü–∏—è –µ—Å—Ç—å)

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è v4.0

–í —Å–µ—Ä–≤–∏—Å–µ v4.0 –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:
```
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
DATABASE_URL=postgresql://... (–∏–∑ Postgres —Å–µ—Ä–≤–∏—Å–∞)
DEV_MODE=0
```

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ):
```
BOT_NAME=spin_bot
PORT=8080
SCENARIO_PATH=scenarios/spin_sales/config.json
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=0
WRITE_PID_FILE=0
```

#### LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:
```
OPENAI_API_KEY=–≤–∞—à_–∫–ª—é—á
ANTHROPIC_API_KEY=–≤–∞—à_–∫–ª—é—á
LLM_TIMEOUT_SEC=30.0
LLM_MAX_RETRIES=1
RESPONSE_PROVIDER=anthropic
FEEDBACK_PROVIDER=anthropic
CLASSIFICATION_PROVIDER=openai
```

#### –ê–¥–º–∏–Ω:
```
ADMIN_USER_IDS=759603598
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ–ø–ª–æ—è

1. **Settings ‚Üí Build & Deploy:**
   - **Root Directory:** `versions/v4.0` (—É–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
   - **Start Command:** –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Procfile`)
   - –ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ: `python bot.py`

2. **Settings ‚Üí Source:**
   - **Branch:** `v4.0`
   - **Root Directory:** `versions/v4.0`

### –®–∞–≥ 5: –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π

1. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç –¥–µ–ø–ª–æ–π –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
2. –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ **"Deploy"** –≤—Ä—É—á–Ω—É—é
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ **"Logs"**

## üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ PostgreSQL —á–µ—Ä–µ–∑ Railway Variables

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:

### –°–ø–æ—Å–æ–± 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DATABASE_URL –Ω–∞–ø—Ä—è–º—É—é

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç `DATABASE_URL` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
postgresql://postgres:password@host:port/dbname
```

–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ —Å–µ—Ä–≤–∏—Å v4.0, –∏ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç `postgresql://` ‚Üí `postgresql+asyncpg://`
- –î–æ–±–∞–≤–∏—Ç `sslmode=require`

### –°–ø–æ—Å–æ–± 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–ï—Å–ª–∏ Railway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```
PGHOST=...
PGPORT=...
PGUSER=postgres
PGPASSWORD=...
PGDATABASE=railway
```

–°–æ–±–µ—Ä–∏—Ç–µ `DATABASE_URL` –≤—Ä—É—á–Ω—É—é:
```
DATABASE_URL=postgresql://${PGUSER}:${PGPASSWORD}@${PGHOST}:${PGPORT}/${PGDATABASE}
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Logs** –≤ —Å–µ—Ä–≤–∏—Å–µ v4.0
2. –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   - ‚úÖ `Database engine created: postgresql+asyncpg://...`
   - ‚úÖ `Database initialized successfully`
   - ‚úÖ `Application started`

3. –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL`
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `DEV_MODE=0` (–Ω–µ `1`)
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ Railway

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:

```
peaceful-dedication (–ø—Ä–æ–µ–∫—Ç)
‚îú‚îÄ‚îÄ Postgres (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
‚îÇ   ‚îî‚îÄ‚îÄ DATABASE_URL –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ prolific-reflection (—Å—Ç–∞—Ä—ã–π –±–æ—Ç - v3.0)
‚îÇ   ‚îî‚îÄ‚îÄ Branch: main
‚îÇ   ‚îî‚îÄ‚îÄ Root Directory: (–∫–æ—Ä–Ω–µ–≤–∞—è)
‚îÇ   ‚îî‚îÄ‚îÄ –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
‚îÇ
‚îî‚îÄ‚îÄ spin-bot-v4 (–Ω–æ–≤—ã–π –±–æ—Ç - v4.0)
    ‚îî‚îÄ‚îÄ Branch: v4.0
    ‚îî‚îÄ‚îÄ Root Directory: versions/v4.0
    ‚îî‚îÄ‚îÄ DATABASE_URL: –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Postgres
    ‚îî‚îÄ‚îÄ DEV_MODE=0
```

## üîÑ –û—Ç–∫–∞—Ç (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

–ï—Å–ª–∏ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –°—Ç–∞—Ä—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å (–Ω–µ —Ç—Ä–æ–Ω—É—Ç)
2. –ú–æ–∂–µ—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å: **Settings** ‚Üí **Delete Service**
3. –ò–ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å

## üìù –ß–µ–∫–ª–∏—Å—Ç

- [ ] –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å —Å–æ–∑–¥–∞–Ω –≤ Railway
- [ ] Branch —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `v4.0`
- [ ] Root Directory —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `versions/v4.0`
- [ ] PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω (DATABASE_URL –¥–æ–±–∞–≤–ª–µ–Ω)
- [ ] DEV_MODE=0 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] BOT_TOKEN —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] LLM –∫–ª—é—á–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –î–µ–ø–ª–æ–π –∑–∞–ø—É—â–µ–Ω
- [ ] –õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã (–Ω–µ—Ç –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î)

