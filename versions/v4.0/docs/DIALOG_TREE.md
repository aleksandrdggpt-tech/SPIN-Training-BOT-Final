# üå≥ –î–µ—Ä–µ–≤–æ –¥–∏–∞–ª–æ–≥–æ–≤ SPIN Training Bot

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞](#–∫–æ–º–∞–Ω–¥—ã-–±–æ—Ç–∞)
2. [–û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏](#–æ—Å–Ω–æ–≤–Ω–æ–π-–ø–æ—Ç–æ–∫-—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏)
3. [–ü–ª–∞—Ç–µ–∂–Ω—ã–π –º–æ–¥—É–ª—å](#–ø–ª–∞—Ç–µ–∂–Ω—ã–π-–º–æ–¥—É–ª—å)
4. [SPIN Sales Funnel](#spin-sales-funnel)
5. [–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å](#–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)
6. [–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞](#—Å–æ—Å—Ç–æ—è–Ω–∏—è-–¥–∏–∞–ª–æ–≥–∞)

---

## üéØ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```
/start
  ‚îî‚îÄ> –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –æ–ø—Ü–∏—è–º–∏
      ‚îú‚îÄ> üí≥ –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
      ‚îú‚îÄ> üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
      ‚îú‚îÄ> üéüÔ∏è –£ –º–µ–Ω—è –µ—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
      ‚îî‚îÄ> ‚ùì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

/scenario
  ‚îî‚îÄ> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏

/stats
  ‚îî‚îÄ> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –≤–æ–ø—Ä–æ—Å—ã, –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)

/rank
  ‚îî‚îÄ> –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–Ω–≥–µ, —É—Ä–æ–≤–Ω–µ, XP –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö

/case –∏–ª–∏ /caseinfo
  ‚îî‚îÄ> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –∫–µ–π—Å–µ (–µ—Å–ª–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞)

/help
  ‚îî‚îÄ> –°–ø—Ä–∞–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–º–∞–Ω–¥–∞–º

/author
  ‚îî‚îÄ> –ö–æ–Ω—Ç–∞–∫—Ç—ã –∞–≤—Ç–æ—Ä–∞ –∏ –ø–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

/validate
  ‚îî‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
```

### –ü–ª–∞—Ç–µ–∂–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```
/payment –∏–ª–∏ /buy –∏–ª–∏ /subscribe
  ‚îî‚îÄ> –ú–µ–Ω—é –ø–ª–∞—Ç–µ–∂–µ–π —Å —Å—Ç–∞—Ç—É—Å–æ–º –ø–æ–¥–ø–∏—Å–∫–∏

/promo <–∫–æ–¥>
  ‚îî‚îÄ> –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞–ø—Ä—è–º—É—é
```

### –ê–¥–º–∏–Ω –∫–æ–º–∞–Ω–¥—ã
```
/admin
  ‚îî‚îÄ> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
```

---

## üèãÔ∏è –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

### 1. –ù–∞—á–∞–ª–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–æ—Å—Ç—É–ø–æ–º ‚Üí –ö–Ω–æ–ø–∫–∞ "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É"
  ‚îî‚îÄ> callback: start:training
      ‚îî‚îÄ> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–µ–π—Å–∞
          ‚îî‚îÄ> –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–µ–π—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
              ‚îî‚îÄ> chat_state = 'training_active'
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí /start
  ‚îî‚îÄ> –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –º–µ–Ω—é
      ‚îî‚îÄ> –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø ‚Üí –ö–Ω–æ–ø–∫–∞ "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É"
          ‚îî‚îÄ> (—Å–º. –í–∞—Ä–∏–∞–Ω—Ç A)
```

**–í–∞—Ä–∏–∞–Ω—Ç C: –ß–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí "–Ω–∞—á–∞—Ç—å" –∏–ª–∏ "—Å—Ç–∞—Ä—Ç"
  ‚îî‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞ chat_state == 'waiting_start'
      ‚îî‚îÄ> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–µ–π—Å–∞
          ‚îî‚îÄ> –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–µ–π—Å–∞
              ‚îî‚îÄ> chat_state = 'training_active'
```

### 2. –ê–∫—Ç–∏–≤–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (chat_state = 'training_active')

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å
  ‚îî‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞:
      ‚îú‚îÄ> –î–ª–∏–Ω–∞ –≤–æ–ø—Ä–æ—Å–∞ > 5 —Å–∏–º–≤–æ–ª–æ–≤
      ‚îú‚îÄ> question_count < max_questions (10)
      ‚îî‚îÄ> chat_state == 'training_active'
          ‚îî‚îÄ> –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–∞:
              ‚îú‚îÄ> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è SPIN-–≤–æ–ø—Ä–æ—Å–∞
              ‚îú‚îÄ> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞
              ‚îú‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–ª—É—à–∞–Ω–∏—è
              ‚îú‚îÄ> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
              ‚îî‚îÄ> –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞
                  ‚îî‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
                      ‚îú‚îÄ> clarity_level >= target_clarity (80%)
                      ‚îÇ   ‚îî‚îÄ> –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ + –æ—Ç—á–µ—Ç
                      ‚îî‚îÄ> question_count >= max_questions
                          ‚îî‚îÄ> –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ + –æ—Ç—á–µ—Ç
```

### 3. –ó–∞–ø—Ä–æ—Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí "–î–ê"
  ‚îî‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω—Ç–∏–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è:
      ‚îú‚îÄ> feedback_in_progress == False
      ‚îî‚îÄ> (now - last_feedback_ts) >= 5 —Å–µ–∫—É–Ω–¥
          ‚îî‚îÄ> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏–¥–±–µ–∫–∞:
              ‚îú‚îÄ> –ü–æ–ø—ã—Ç–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ (stream_feedback)
              ‚îî‚îÄ> –†–µ–∑–µ—Ä–≤–Ω—ã–π –ø—É—Ç—å (get_feedback)
                  ‚îî‚îÄ> –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∏–¥–±–µ–∫–∞
```

### 4. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

**–í–∞—Ä–∏–∞–Ω—Ç A: –ö–æ–º–∞–Ω–¥–∞**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí "–∑–∞–≤–µ—Ä—à–∏—Ç—å"
  ‚îî‚îÄ> complete_training()
      ‚îî‚îÄ> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞:
          ‚îú‚îÄ> –ë–∞–∑–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
          ‚îú‚îÄ> –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
          ‚îú‚îÄ> –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–ª—É—à–∞–Ω–∏–µ
          ‚îú‚îÄ> –†–∞–Ω–≥ –∏ XP
          ‚îú‚îÄ> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
          ‚îú‚îÄ> –ù–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
          ‚îî‚îÄ> –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é + –ø—Ä–æ–º–æ
              ‚îî‚îÄ> –ö–Ω–æ–ø–∫–∞ "üîÑ –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É"
                  ‚îî‚îÄ> callback: start:training
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ**
```
–î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —Ü–µ–ª–µ–≤–∞—è —è—Å–Ω–æ—Å—Ç—å (clarity >= 80%)
  ‚îî‚îÄ> –°–æ–æ–±—â–µ–Ω–∏–µ –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —è—Å–Ω–æ—Å—Ç–∏
      ‚îî‚îÄ> complete_training()
          ‚îî‚îÄ> (—Å–º. –í–∞—Ä–∏–∞–Ω—Ç A)

–ò–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ (question_count >= 10)
  ‚îî‚îÄ> complete_training()
      ‚îî‚îÄ> (—Å–º. –í–∞—Ä–∏–∞–Ω—Ç A)
```

---

## üí≥ –ü–ª–∞—Ç–µ–∂–Ω—ã–π –º–æ–¥—É–ª—å

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –ø–ª–∞—Ç–µ–∂–µ–π

```
/payment
  ‚îî‚îÄ> –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ + –º–µ–Ω—é:
      ‚îú‚îÄ> üí≥ –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
      ‚îÇ   ‚îî‚îÄ> callback: payment:show_tariffs
      ‚îÇ       ‚îî‚îÄ> –°–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤:
      ‚îÇ           ‚îú‚îÄ> üìÖ –ú–µ—Å—è—á–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ ‚Äî 990‚ÇΩ
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:select_tariff:month
      ‚îÇ           ‚îî‚îÄ> üéØ –ì–æ–¥–æ–≤–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ ‚Äî 6990‚ÇΩ
      ‚îÇ               ‚îî‚îÄ> callback: payment:select_tariff:year
      ‚îÇ                   ‚îî‚îÄ> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞:
      ‚îÇ                       ‚îú‚îÄ> ‚úÖ –û–ø–ª–∞—Ç–∏—Ç—å
      ‚îÇ                       ‚îÇ   ‚îî‚îÄ> callback: payment:pay:{tariff_id}
      ‚îÇ                       ‚îÇ       ‚îî‚îÄ> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–ø–ª–∞—Ç—É
      ‚îÇ                       ‚îú‚îÄ> üìã –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–∞—Ä–∏—Ñ–µ
      ‚îÇ                       ‚îî‚îÄ> ¬´ –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Ç–∞—Ä–∏—Ñ
      ‚îÇ
      ‚îú‚îÄ> üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
      ‚îÇ   ‚îî‚îÄ> callback: payment:free_access
      ‚îÇ       ‚îî‚îÄ> –û–ø—Ü–∏–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:
      ‚îÇ           ‚îú‚îÄ> üì¢ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª
      ‚îÇ           ‚îú‚îÄ> ‚úÖ –Ø –ø–æ–¥–ø–∏—Å–∞–ª—Å—è, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:check_subscription
      ‚îÇ           ‚îÇ       ‚îî‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏:
      ‚îÇ           ‚îÇ           ‚îú‚îÄ> –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∞–Ω ‚Üí –ë–æ–Ω—É—Å + –∫–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É"
      ‚îÇ           ‚îÇ           ‚îî‚îÄ> –ï—Å–ª–∏ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω ‚Üí –°–æ–æ–±—â–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
      ‚îÇ           ‚îú‚îÄ> üéüÔ∏è –í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥
      ‚îÇ           ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
      ‚îÇ
      ‚îú‚îÄ> üéüÔ∏è –£ –º–µ–Ω—è –µ—Å—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
      ‚îÇ   ‚îî‚îÄ> callback: payment:enter_promo
      ‚îÇ       ‚îî‚îÄ> ConversationHandler:
      ‚îÇ           ‚îú‚îÄ> –°–æ—Å—Ç–æ—è–Ω–∏–µ: WAITING_CODE
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ø—Ä–æ–º–æ–∫–æ–¥
      ‚îÇ           ‚îÇ       ‚îî‚îÄ> process_promocode()
      ‚îÇ           ‚îÇ           ‚îú‚îÄ> –ï—Å–ª–∏ –≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –ê–∫—Ç–∏–≤–∞—Ü–∏—è + –∫–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É"
      ‚îÇ           ‚îÇ           ‚îî‚îÄ> –ï—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
      ‚îÇ           ‚îî‚îÄ> Fallback: ¬´ –û—Ç–º–µ–Ω–∞
      ‚îÇ               ‚îî‚îÄ> callback: payment:cancel_promo
      ‚îÇ
      ‚îî‚îÄ> ‚ùì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?
          ‚îî‚îÄ> callback: payment:how_it_works
              ‚îî‚îÄ> SPIN Sales Funnel (—Å–º. —Ä–∞–∑–¥–µ–ª –Ω–∏–∂–µ)
```

### –ü—Ä–æ–º–æ–∫–æ–¥ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É

```
/promo <–∫–æ–¥>
  ‚îî‚îÄ> –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞ –Ω–∞–ø—Ä—è–º—É—é
      ‚îú‚îÄ> –ï—Å–ª–∏ –≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –ê–∫—Ç–∏–≤–∞—Ü–∏—è + –∫–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É"
      ‚îî‚îÄ> –ï—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
```

---

## üéØ SPIN Sales Funnel

### –ì–∏–±—Ä–∏–¥–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è)

```
payment:how_it_works
  ‚îî‚îÄ> SOCIAL_PROOF_SHORT + BENEFITS_SHORT
      ‚îú‚îÄ> üöÄ –ü–æ–Ω—è—Ç–Ω–æ, —Ö–æ—á—É –Ω–∞—á–∞—Ç—å!
      ‚îÇ   ‚îî‚îÄ> callback: payment:show_tariffs
      ‚îÇ       ‚îî‚îÄ> –°–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤
      ‚îÇ
      ‚îú‚îÄ> ü§î –ó–≤—É—á–∏—Ç —Ö–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å —Å–æ–º–Ω–µ–Ω–∏—è
      ‚îÇ   ‚îî‚îÄ> callback: payment:objections
      ‚îÇ       ‚îî‚îÄ> SPIN_S_SITUATION (—Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –º–µ—Ç–∞—Ñ–æ—Ä–∞)
      ‚îÇ           ‚îú‚îÄ> üëç –î–∞, —ç—Ç–æ –ø—Ä–æ –º–µ–Ω—è
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:spin:yes
      ‚îÇ           ‚îÇ       ‚îî‚îÄ> SPIN P (Problem) - –ó–æ–Ω—ã —Ä–æ—Å—Ç–∞
      ‚îÇ           ‚îÇ           ‚îú‚îÄ> üëç –î–∞, —É–∑–Ω–∞—é
      ‚îÇ           ‚îÇ           ‚îú‚îÄ> ü§î –ù–µ —Å–æ–≤—Å–µ–º
      ‚îÇ           ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:spin:p_continue
      ‚îÇ           ‚îÇ           ‚îÇ       ‚îî‚îÄ> SPIN I (Implication) - –¶–µ–Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
      ‚îÇ           ‚îÇ           ‚îÇ           ‚îî‚îÄ> ‚úÖ –î–∞, —Ö–æ—á—É –ø–æ–Ω—è—Ç—å
      ‚îÇ           ‚îÇ           ‚îÇ               ‚îî‚îÄ> callback: payment:spin:i_continue
      ‚îÇ           ‚îÇ           ‚îÇ                   ‚îî‚îÄ> SPIN N (Need-payoff) - –†–µ—à–µ–Ω–∏–µ
      ‚îÇ           ‚îÇ           ‚îÇ                       ‚îú‚îÄ> üöÄ –ó–≤—É—á–∏—Ç –ø–æ–ª–µ–∑–Ω–æ, —Ö–æ—á—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è
      ‚îÇ           ‚îÇ           ‚îÇ                       ‚îÇ   ‚îî‚îÄ> callback: payment:show_tariffs
      ‚îÇ           ‚îÇ           ‚îÇ                       ‚îú‚îÄ> üéÅ –°–Ω–∞—á–∞–ª–∞ —Ö–æ—á—É –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
      ‚îÇ           ‚îÇ           ‚îÇ                       ‚îÇ   ‚îî‚îÄ> callback: payment:free_access
      ‚îÇ           ‚îÇ           ‚îÇ                       ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
      ‚îÇ           ‚îÇ           ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
      ‚îÇ           ‚îÇ               ‚îî‚îÄ> callback: payment:spin:back
      ‚îÇ           ‚îÇ
      ‚îÇ           ‚îî‚îÄ> ü§î –£ –º–µ–Ω—è –≤—Å—ë –Ω–µ–ø–ª–æ—Ö–æ
      ‚îÇ               ‚îî‚îÄ> callback: payment:spin:no
      ‚îÇ                   ‚îî‚îÄ> SPIN P (Problem) - –ó–æ–Ω—ã —Ä–æ—Å—Ç–∞
      ‚îÇ
      ‚îÇ           ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
      ‚îÇ               ‚îî‚îÄ> callback: payment:how_it_works
      ‚îÇ
      ‚îú‚îÄ> ‚öôÔ∏è –ö–∞–∫ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?
      ‚îÇ   ‚îî‚îÄ> callback: payment:mechanics
      ‚îÇ       ‚îî‚îÄ> HOW_IT_WORKS (–ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è)
      ‚îÇ           ‚îú‚îÄ> üí≥ –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:show_tariffs
      ‚îÇ           ‚îú‚îÄ> üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:free_access
      ‚îÇ           ‚îú‚îÄ> ü§î –ó–≤—É—á–∏—Ç —Ö–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å —Å–æ–º–Ω–µ–Ω–∏—è
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:objections
      ‚îÇ           ‚îÇ       ‚îî‚îÄ> SPIN_S_SITUATION (—Ä–∞–±–æ—Ç–∞ —Å –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è–º–∏)
      ‚îÇ           ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
      ‚îÇ               ‚îî‚îÄ> callback: payment:how_it_works
      ‚îÇ
      ‚îú‚îÄ> üéÅ –•–æ—á—É –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
      ‚îÇ   ‚îî‚îÄ> callback: payment:free_access
      ‚îÇ
      ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
          ‚îî‚îÄ> callback: payment:back_to_menu
```

### –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –≤–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ (S-P-I-N) - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å

```
payment:how_it_works (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
  ‚îî‚îÄ> SPIN S (Situation) - –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞
      ‚îú‚îÄ> üëç –î–∞, —ç—Ç–æ –ø—Ä–æ –º–µ–Ω—è
      ‚îÇ   ‚îî‚îÄ> callback: payment:spin:yes
      ‚îÇ       ‚îî‚îÄ> SPIN P (Problem) - –ó–æ–Ω—ã —Ä–æ—Å—Ç–∞
      ‚îÇ           ‚îú‚îÄ> üëç –î–∞, —É–∑–Ω–∞—é
      ‚îÇ           ‚îú‚îÄ> ü§î –ù–µ —Å–æ–≤—Å–µ–º
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> callback: payment:spin:p_continue
      ‚îÇ           ‚îÇ       ‚îî‚îÄ> SPIN I (Implication) - –¶–µ–Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
      ‚îÇ           ‚îÇ           ‚îî‚îÄ> ‚úÖ –î–∞, —Ö–æ—á—É –ø–æ–Ω—è—Ç—å
      ‚îÇ           ‚îÇ               ‚îî‚îÄ> callback: payment:spin:i_continue
      ‚îÇ           ‚îÇ                   ‚îî‚îÄ> SPIN N (Need-payoff) - –†–µ—à–µ–Ω–∏–µ
      ‚îÇ           ‚îÇ                       ‚îú‚îÄ> üöÄ –ó–≤—É—á–∏—Ç –ø–æ–ª–µ–∑–Ω–æ, —Ö–æ—á—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è
      ‚îÇ           ‚îÇ                       ‚îÇ   ‚îî‚îÄ> callback: payment:show_tariffs
      ‚îÇ           ‚îÇ                       ‚îú‚îÄ> üéÅ –°–Ω–∞—á–∞–ª–∞ —Ö–æ—á—É –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
      ‚îÇ           ‚îÇ                       ‚îÇ   ‚îî‚îÄ> callback: payment:free_access
      ‚îÇ           ‚îÇ                       ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
      ‚îÇ           ‚îî‚îÄ> ¬´ –ù–∞–∑–∞–¥
      ‚îÇ               ‚îî‚îÄ> callback: payment:spin:back
      ‚îÇ                   ‚îî‚îÄ> –í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —ç–∫—Ä–∞–Ω—É
      ‚îÇ
      ‚îî‚îÄ> ü§î –£ –º–µ–Ω—è –≤—Å—ë –Ω–µ–ø–ª–æ—Ö–æ
          ‚îî‚îÄ> callback: payment:spin:no
              ‚îî‚îÄ> –í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
```

---

## üîß –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∞

```
/admin (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
  ‚îî‚îÄ> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:
      ‚îú‚îÄ> ‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
      ‚îÇ   ‚îî‚îÄ> callback: admin:create_promo
      ‚îÇ       ‚îî‚îÄ> ConversationHandler –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:
      ‚îÇ           ‚îú‚îÄ> –®–∞–≥ 1: –í–≤–æ–¥ –∫–æ–¥–∞
      ‚îÇ           ‚îÇ   ‚îî‚îÄ> –°–æ—Å—Ç–æ—è–Ω–∏–µ: WAITING_CODE
      ‚îÇ           ‚îÇ       ‚îî‚îÄ> –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–∞
      ‚îÇ           ‚îÇ           ‚îî‚îÄ> –®–∞–≥ 2: –í—ã–±–æ—Ä —Ç–∏–ø–∞
      ‚îÇ           ‚îÇ               ‚îî‚îÄ> callback: admin:promo_type:{type}
      ‚îÇ           ‚îÇ                   ‚îî‚îÄ> –°–æ—Å—Ç–æ—è–Ω–∏–µ: WAITING_TYPE
      ‚îÇ           ‚îÇ                       ‚îî‚îÄ> –®–∞–≥ 3: –í–≤–æ–¥ –∑–Ω–∞—á–µ–Ω–∏—è
      ‚îÇ           ‚îÇ                           ‚îî‚îÄ> –°–æ—Å—Ç–æ—è–Ω–∏–µ: WAITING_VALUE
      ‚îÇ           ‚îÇ                               ‚îî‚îÄ> –®–∞–≥ 4: –ú–∞–∫—Å–∏–º—É–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
      ‚îÇ           ‚îÇ                                   ‚îî‚îÄ> –°–æ—Å—Ç–æ—è–Ω–∏–µ: WAITING_MAX_USES
      ‚îÇ           ‚îÇ                                       ‚îî‚îÄ> –®–∞–≥ 5: –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
      ‚îÇ           ‚îÇ                                           ‚îî‚îÄ> –°–æ—Å—Ç–æ—è–Ω–∏–µ: WAITING_EXPIRES
      ‚îÇ           ‚îÇ                                               ‚îî‚îÄ> –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
      ‚îÇ           ‚îÇ                                                   ‚îî‚îÄ> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
      ‚îÇ           ‚îî‚îÄ> Fallback: ‚ùå –û—Ç–º–µ–Ω–∞
      ‚îÇ               ‚îî‚îÄ> callback: admin:cancel_promo
      ‚îÇ
      ‚îú‚îÄ> üìã –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
      ‚îÇ   ‚îî‚îÄ> callback: admin:list_promos
      ‚îÇ       ‚îî‚îÄ> –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ (–¥–æ 20)
      ‚îÇ           ‚îî‚îÄ> ‚óÄÔ∏è –ù–∞–∑–∞–¥
      ‚îÇ               ‚îî‚îÄ> callback: admin:back
      ‚îÇ
      ‚îú‚îÄ> üéÅ –í—ã–¥–∞—Ç—å –¥–æ—Å—Ç—É–ø
      ‚îÇ   ‚îî‚îÄ> callback: admin:give_access
      ‚îÇ       ‚îî‚îÄ> –í—ã–¥–∞—á–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
      ‚îÇ
      ‚îú‚îÄ> üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
      ‚îÇ   ‚îî‚îÄ> callback: admin:stats
      ‚îÇ       ‚îî‚îÄ> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞
      ‚îÇ
      ‚îî‚îÄ> ‚óÄÔ∏è –ù–∞–∑–∞–¥ (–µ—Å–ª–∏ –µ—Å—Ç—å)
          ‚îî‚îÄ> callback: admin:back
              ‚îî‚îÄ> –í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∞
```

---

## üìä –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞

### –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–∏ (chat_state)

```
'waiting_start'
  ‚îî‚îÄ> –û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
      ‚îî‚îÄ> –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: "–Ω–∞—á–∞—Ç—å", "—Å—Ç–∞—Ä—Ç"

'training_active'
  ‚îî‚îÄ> –ê–∫—Ç–∏–≤–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
      ‚îî‚îÄ> –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: –≤–æ–ø—Ä–æ—Å—ã, "–î–ê", "–∑–∞–≤–µ—Ä—à–∏—Ç—å"
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π (PaymentStates)

```
MAIN_MENU
  ‚îî‚îÄ> –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –ø–ª–∞—Ç–µ–∂–µ–π

SELECTING_TARIFF
  ‚îî‚îÄ> –í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞

CONFIRMING_PAYMENT
  ‚îî‚îÄ> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞ (PromoInputStates)

```
WAITING_CODE
  ‚îî‚îÄ> –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞ (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è –∞–¥–º–∏–Ω-–ø—Ä–æ–º–æ–∫–æ–¥–∞ (AdminPromoStates)

```
WAITING_CODE
  ‚îî‚îÄ> –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –∫–æ–¥–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞

WAITING_TYPE
  ‚îî‚îÄ> –û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞

WAITING_VALUE
  ‚îî‚îÄ> –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –∑–Ω–∞—á–µ–Ω–∏—è (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫/–¥–Ω–µ–π)

WAITING_MAX_USES
  ‚îî‚îÄ> –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

WAITING_EXPIRES
  ‚îî‚îÄ> –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
```

---

## üîÑ Callback Patterns

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

```
start:training
  ‚îî‚îÄ> –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É

payment:*
  ‚îú‚îÄ> show_tariffs - –ü–æ–∫–∞–∑–∞—Ç—å —Ç–∞—Ä–∏—Ñ—ã
  ‚îú‚îÄ> select_tariff:{id} - –í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ
  ‚îú‚îÄ> pay:{id} - –û–ø–ª–∞—Ç–∏—Ç—å —Ç–∞—Ä–∏—Ñ
  ‚îú‚îÄ> free_access - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø
  ‚îú‚îÄ> check_subscription - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
  ‚îú‚îÄ> enter_promo - –í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥
  ‚îú‚îÄ> cancel_promo - –û—Ç–º–µ–Ω–∏—Ç—å –≤–≤–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞
  ‚îú‚îÄ> back_to_menu - –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é
  ‚îú‚îÄ> close - –ó–∞–∫—Ä—ã—Ç—å
  ‚îú‚îÄ> how_it_works - –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–≥–∏–±—Ä–∏–¥–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞)
  ‚îú‚îÄ> objections - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π (–∑–∞–ø—É—Å–∫ SPIN S)
  ‚îú‚îÄ> mechanics - –î–µ—Ç–∞–ª—å–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
  ‚îî‚îÄ> spin:*
      ‚îú‚îÄ> yes - –î–∞ (S-—ç–∫—Ä–∞–Ω)
      ‚îú‚îÄ> no - –ù–µ—Ç (S-—ç–∫—Ä–∞–Ω)
      ‚îú‚îÄ> p_continue - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å (P-—ç–∫—Ä–∞–Ω)
      ‚îú‚îÄ> i_continue - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å (I-—ç–∫—Ä–∞–Ω)
      ‚îî‚îÄ> back - –ù–∞–∑–∞–¥

admin:*
  ‚îú‚îÄ> create_promo - –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
  ‚îú‚îÄ> list_promos - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
  ‚îú‚îÄ> give_access - –í—ã–¥–∞—Ç—å –¥–æ—Å—Ç—É–ø
  ‚îú‚îÄ> stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  ‚îú‚îÄ> back - –ù–∞–∑–∞–¥
  ‚îú‚îÄ> cancel_promo - –û—Ç–º–µ–Ω–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
  ‚îî‚îÄ> promo_type:{type} - –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –ø—Ä–æ–º–æ–∫–æ–¥–∞
```

---

## üìù –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ —á–∞—Ç–µ

```
"–Ω–∞—á–∞—Ç—å" –∏–ª–∏ "—Å—Ç–∞—Ä—Ç"
  ‚îî‚îÄ> –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (–µ—Å–ª–∏ chat_state == 'waiting_start')

"–î–ê"
  ‚îî‚îÄ> –ü–æ–ª—É—á–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –≤–æ–ø—Ä–æ—Å—É

"–∑–∞–≤–µ—Ä—à–∏—Ç—å"
  ‚îî‚îÄ> –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∏ –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç
```

---

## üéØ –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
  ‚îî‚îÄ> check_access()
      ‚îú‚îÄ> –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ ‚Üí –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω
      ‚îú‚îÄ> –ï—Å–ª–∏ –µ—Å—Ç—å trainings_left > 0 ‚Üí –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω
      ‚îî‚îÄ> –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é –ø–ª–∞—Ç–µ–∂–µ–π
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

```
1. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª
   ‚îî‚îÄ> check_subscription_callback
       ‚îî‚îÄ> grant_channel_subscription_bonus
           ‚îî‚îÄ> +2 –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

2. –ü—Ä–æ–º–æ–∫–æ–¥
   ‚îî‚îÄ> process_promocode / promo_command
       ‚îî‚îÄ> activate_promocode
           ‚îî‚îÄ> –î–æ—Å—Ç—É–ø –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞

3. –ü–æ–∫—É–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
   ‚îî‚îÄ> pay_callback
       ‚îî‚îÄ> –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
           ‚îî‚îÄ> –î–æ—Å—Ç—É–ø –Ω–∞ –ø–µ—Ä–∏–æ–¥ –ø–æ–¥–ø–∏—Å–∫–∏
```

---

## üîê –ê–Ω—Ç–∏–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí "–î–ê"
  ‚îî‚îÄ> –ü—Ä–æ–≤–µ—Ä–∫–∞:
      ‚îú‚îÄ> feedback_in_progress == False
      ‚îî‚îÄ> (now - last_feedback_ts) >= 5 —Å–µ–∫—É–Ω–¥
          ‚îî‚îÄ> –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏–¥–±–µ–∫–∞
          ‚îî‚îÄ> –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞ ‚Üí –°–æ–æ–±—â–µ–Ω–∏–µ "–§–∏–¥–±–µ–∫ —É–∂–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è..."
```

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**: Callback handlers —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
2. **ConversationHandler**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–≤–æ–¥–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞–¥–º–∏–Ω—ã)
3. **–°–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–∏**: –£–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `chat_state` –≤ –æ–±—ä–µ–∫—Ç–µ —Å–µ—Å—Å–∏–∏
4. **–û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**: –ü—Ä–∏ –Ω–∞—á–∞–ª–µ –Ω–æ–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `reset_session()` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

> **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** —Å–º. –≤ —Ñ–∞–π–ª–µ [PERFORMANCE.md](PERFORMANCE.md)

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-01-16*

