# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ GPT-5-mini

## –ü—Ä–æ–±–ª–µ–º–∞

–ú–æ–¥–µ–ª—å `gpt-5-mini` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π Responses API –≤–º–µ—Å—Ç–æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ Chat Completions API, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫–∏:

```
Error code: 400 - Unsupported parameter: 'max_tokens' is not supported with this model. Use 'max_completion_tokens' instead.
```

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Responses API –¥–ª—è GPT-5

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ GPT-5 API:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `client.responses.create()` –≤–º–µ—Å—Ç–æ `client.chat.completions.create()`
- –¢—Ä–µ–±—É–µ—Ç `max_completion_tokens` –≤–º–µ—Å—Ç–æ `max_tokens`
- –ò–º–µ–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `reasoning` –∏ `text`
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç system –∏ user —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ–¥–Ω–æ –ø–æ–ª–µ `input`

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–∑–æ–≤–∞ API

```python
# –î–ª—è GPT-5 –∏—Å–ø–æ–ª—å–∑—É–µ–º Responses API
if str(model_name).startswith("gpt-5"):
    combined_message = f"System: {system_prompt}\n\nUser: {user_message}"
    payload = {
        "model": model_name,
        "input": combined_message,
        "reasoning": {
            "effort": "minimal" if kind == 'classification' else "medium"
        },
        "text": {
            "verbosity": "low" if kind == 'classification' else "medium"
        },
        "max_completion_tokens": max_tokens,
    }
    resp = await client.responses.create(**payload)
    return (resp.output_text or "").strip()
```

### 3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã GPT-5

**reasoning.effort:**
- `minimal` - –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
- `medium` - –¥–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (feedback, response)

**text.verbosity:**
- `low` - –∫—Ä–∞—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
- `medium` - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (feedback, response)

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```python
PRIMARY_MODEL: gpt-4o-mini
FALLBACK_MODEL: gpt-5-mini  # –¢–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ GPT-5-mini

### üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **–ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è** - –ø–∞—Ä–∞–º–µ—Ç—Ä `reasoning.effort`
- **–ì–∏–±–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è** - –ø–∞—Ä–∞–º–µ—Ç—Ä `text.verbosity`

### üí∞ –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å:
- **–ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å** - mini –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏
- **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤** - —Ç–æ—á–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `max_completion_tokens`

### üéØ –ö–∞—á–µ—Å—Ç–≤–æ:
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –Ω–æ–≤–µ–π—à–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ OpenAI
- **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ** - –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- **–ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–∏–ø –∑–∞–¥–∞—á–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
1. **GPT-4o-mini —Ä–∞–±–æ—Ç–∞–µ—Ç** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è primary –º–æ–¥–µ–ª—å
2. **GPT-4o-mini –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ GPT-5-mini
3. **GPT-5-mini Responses API** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
4. **Fallback –Ω–∞ Anthropic** - –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –æ–±–µ–∏—Ö OpenAI –º–æ–¥–µ–ª–µ–π

### üß™ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
cd "/Users/aleksandrdg/Projects/SPIN Training BOT Final"
source venv/bin/activate
python3 bot.py

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPT-5
python3 -c "
import asyncio
from services.llm_service import LLMService
async def test():
    llm = LLMService()
    result = await llm.call_llm('feedback', '–¢—ã –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫', '–¢–µ—Å—Ç GPT-5')
    print(result)
asyncio.run(test())
"
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### üìä –õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- `OpenAI Responses payload:` - –∑–∞–ø—Ä–æ—Å—ã –∫ GPT-5
- `OpenAI Chat payload:` - –∑–∞–ø—Ä–æ—Å—ã –∫ GPT-4o
- `LLM fallback:` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏

### üîç –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç—ã GPT-5:
- **Responses API**: `client.responses.create()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `reasoning`, `text`, `max_completion_tokens`
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: `input` –≤–º–µ—Å—Ç–æ `messages`

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏:
- **GPT-5-mini** - Responses API
- **GPT-4o-mini** - Chat Completions API —Å `max_completion_tokens`
- **GPT-4o** - Chat Completions API —Å `max_completion_tokens`
- **–î—Ä—É–≥–∏–µ GPT –º–æ–¥–µ–ª–∏** - Chat Completions API —Å `max_tokens`

### üîÑ Fallback —Ü–µ–ø–æ—á–∫–∞:
1. **Primary**: GPT-4o-mini (Chat Completions)
2. **Fallback 1**: GPT-5-mini (Responses API)
3. **Fallback 2**: Anthropic Claude (REST API)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ API** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–∏–º–∏—Ç–∞–º–∏ GPT-5
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–±–æ—Ç—É Responses API
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É API

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏
2. **–û—Ç–ª–∞–¥–∫–∞** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É payload –¥–ª—è —Ä–∞–∑–Ω—ã—Ö API
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `reasoning` –∏ `text`

## –°—Ç–∞—Ç—É—Å

**‚úÖ –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

- GPT-5-mini Responses API –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- Fallback –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
